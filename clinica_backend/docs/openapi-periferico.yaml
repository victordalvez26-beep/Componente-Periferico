openapi: 3.0.3
info:
  title: Componente Perif茅rico API
  description: |
    API del componente perif茅rico que permite a las cl铆nicas gestionar documentos cl铆nicos
    y enviar sus metadatos al HCEN central.
  version: 1.0.0
  contact:
    name: Componente Perif茅rico Development Team

servers:
  - url: http://127.0.0.1:8080/hcen-web/api
    description: Servidor local de desarrollo (usar 127.0.0.1 en lugar de localhost)

paths:
  /health:
    get:
      summary: Health check
      description: Verifica que el servicio est谩 funcionando
      operationId: healthCheck
      tags:
        - Health
      responses:
        '200':
          description: Servicio funcionando
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: UP

  /auth/login:
    post:
      summary: Login
      description: Autentica un usuario y devuelve un token JWT
      operationId: login
      tags:
        - Autenticaci贸n
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            example:
              nickname: "admin_c101"
              password: "password123"
      responses:
        '200':
          description: Login exitoso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Credenciales incorrectas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /auth/logout:
    post:
      summary: Logout
      description: Cierra sesi贸n (stateless, el cliente descarta el token)
      operationId: logout
      tags:
        - Autenticaci贸n
      responses:
        '200':
          description: Logout exitoso
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string

  /config/init:
    post:
      summary: Inicializar tenant
      description: Crea un nuevo tenant (cl铆nica) y usuario administrador
      operationId: initTenant
      tags:
        - Configuraci贸n
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitRequest'
            example:
              tenantId: "101"
              nombre: "Cl铆nica Test"
              rut: "11111111"
              colorPrimario: "#007bff"
              nombrePortal: "Cl铆nica Test"
              adminEmail: "admin@test.com"
      responses:
        '200':
          description: Tenant creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitResponse'
        '400':
          description: Error de validaci贸n
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /config/activate-simple:
    post:
      summary: Activar usuario admin
      description: Activa un usuario administrador con token y contrase帽a
      operationId: activateSimple
      tags:
        - Configuraci贸n
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - tenantId
                - token
                - password
              properties:
                tenantId:
                  type: string
                token:
                  type: string
                password:
                  type: string
      responses:
        '200':
          description: Usuario activado
          content:
            application/json:
              schema:
                type: object
                properties:
                  nickname:
                    type: string
                  message:
                    type: string

  /documentos/completo:
    post:
      summary: Crear documento completo
      description: |
        Crea un documento completo: guarda el contenido en MongoDB y env铆a los metadatos al HCEN central.
        Este es el endpoint principal del flujo completo.
        
        **Autenticaci贸n entre servicios:** El cliente autom谩ticamente genera y env铆a un token JWT de servicio
        al HCEN central cuando se env铆an los metadatos. No se requiere configuraci贸n adicional.
      operationId: crearDocumentoCompleto
      tags:
        - Documentos
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CrearDocumentoRequest'
            example:
              contenido: "Diagn贸stico: Paciente presenta s铆ntomas de gripe. Tratamiento: reposo y paracetamol."
              documentoIdPaciente: "12345678"
              tenantId: "101"
              especialidad: "Medicina General"
              formato: "text/plain"
              autor: "Dr. Juan P茅rez"
              titulo: "Consulta M茅dica"
              languageCode: "es"
              breakingTheGlass: false
              descripcion: "Consulta de rutina"
              datosPatronimicos:
                nombre: "Juan"
                apellido: "Garc铆a"
                fechaNacimiento: "1990-01-15"
      responses:
        '201':
          description: Documento creado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrearDocumentoResponse'
        '400':
          description: Error de validaci贸n
        '403':
          description: No autorizado (tenant incorrecto o falta autenticaci贸n)

  /documentos/{id}:
    get:
      summary: Obtener documento por ID
      description: Obtiene un documento por su MongoDB ID
      operationId: obtenerDocumento
      tags:
        - Documentos
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Documento encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  _id:
                    type: string
                  documentoId:
                    type: string
                  contenido:
                    type: string
        '404':
          description: Documento no encontrado

  /documentos/{id}/contenido:
    get:
      summary: Descargar contenido del documento
      description: |
        Descarga el contenido de un documento cl铆nico.
        
        **锔 Verificaci贸n de Permisos:** Este endpoint verifica autom谩ticamente si el profesional autenticado
        tiene permisos para acceder al documento antes de devolverlo. Si no tiene permisos, retorna 403 Forbidden.
        
        ** Registro de Acceso:** Todos los accesos (exitosos y denegados) se registran autom谩ticamente
        en el servicio de pol铆ticas para auditor铆a.
      operationId: descargarContenido
      tags:
        - Documentos
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID del documento (MongoDB _id hex string)
          schema:
            type: string
            example: "690bb94df439e34986bf1ab7"
      responses:
        '200':
          description: Contenido del documento (acceso permitido)
          content:
            text/plain:
              schema:
                type: string
                example: "Este es el contenido del documento cl铆nico..."
            application/pdf:
              schema:
                type: string
                format: binary
              description: Si el formato es PDF, se devuelve como binario
          headers:
            Content-Disposition:
              description: Header para indicar el nombre del archivo
              schema:
                type: string
                example: 'inline; filename="documento_690bb94df439e34986bf1ab7.txt"'
        '400':
          description: ID inv谩lido o faltante
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "id required"
        '401':
          description: No autenticado o profesional no identificado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Autenticaci贸n requerida"
        '403':
          description: Acceso denegado - No tiene permisos para acceder a este documento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "No tiene permisos para acceder a este documento"
                detail: "No tiene permisos para acceder a este documento"
        '404':
          description: Documento no encontrado o sin contenido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "document not found or invalid id"

  /documentos/paciente/{documentoIdPaciente}/metadatos:
    get:
      summary: Obtener metadatos del paciente
      description: Obtiene todos los metadatos de documentos de un paciente
      operationId: obtenerMetadatosPaciente
      tags:
        - Documentos
      security:
        - bearerAuth: []
      parameters:
        - name: documentoIdPaciente
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Lista de metadatos de documentos del paciente
          content:
            application/json:
              schema:
                type: array
                description: Colecci贸n de metadatos de documentos cl铆nicos del paciente
                items:
                  $ref: '#/components/schemas/MetadatosDocumento'
              example:
                - documentoId: "dbe1515b-b56d-4f46-8b61-1299c88f5d2e"
                  documentoIdPaciente: "12345678"
                  tenantId: "101"
                  especialidad: "Medicina General"
                  formato: "text/plain"
                  autor: "Dr. Juan P茅rez"
                  titulo: "Consulta M茅dica"
                  languageCode: "es"
                  breakingTheGlass: false
                  urlAcceso: "http://127.0.0.1:8080/hcen-web/api/documentos/690bb94df439e34986bf1ab7"
                  fechaCreacion: "2025-01-15T10:30:00"
                  fechaRegistro: "2025-01-15T10:31:00"
                  descripcion: "Consulta de rutina"
        '400':
          description: Error de validaci贸n
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '503':
          description: HCEN no disponible
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /documentos/solicitar-acceso:
    post:
      summary: Solicitar acceso a documentos de un paciente
      description: |
        Permite a un profesional solicitar acceso a documentos cl铆nicos espec铆ficos de un paciente.
        
        La solicitud se crea con estado `PENDIENTE` y debe ser aprobada o rechazada por el paciente
        a trav茅s del servicio de pol铆ticas (`/hcen-politicas-service/api/solicitudes/{id}/aprobar` o `/rechazar`).
        
        Una vez aprobada, se puede crear una pol铆tica de acceso autom谩tica que permita al profesional
        acceder a los documentos del paciente.
      operationId: solicitarAcceso
      tags:
        - Documentos
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - codDocumPaciente
              properties:
                codDocumPaciente:
                  type: string
                  description: CI o documento de identidad del paciente
                  example: "12345678"
                tipoDocumento:
                  type: string
                  description: Tipo de documento espec铆fico (opcional). Si no se especifica, se solicita acceso a todos los documentos.
                  example: "text/plain"
                  nullable: true
                documentoId:
                  type: string
                  description: ID espec铆fico del documento (opcional). Si se especifica, se solicita acceso solo a ese documento.
                  example: "dbe1515b-b56d-4f46-8b61-1299c88f5d2e"
                  nullable: true
                razonSolicitud:
                  type: string
                  description: Raz贸n por la cual se solicita acceso (opcional)
                  example: "Necesito revisar el historial del paciente para una consulta"
                  nullable: true
                especialidad:
                  type: string
                  description: Especialidad del profesional (opcional, se puede obtener del contexto si no se env铆a)
                  example: "Cardiolog铆a"
                  nullable: true
            example:
              codDocumPaciente: "12345678"
              tipoDocumento: "text/plain"
              documentoId: "dbe1515b-b56d-4f46-8b61-1299c88f5d2e"
              razonSolicitud: "Necesito revisar el historial del paciente para una consulta"
              especialidad: "Cardiolog铆a"
      responses:
        '201':
          description: Solicitud de acceso creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  solicitudId:
                    type: integer
                    format: int64
                    description: ID de la solicitud creada
                    example: 1
                  profesionalId:
                    type: string
                    description: ID del profesional que solicit贸 acceso (obtenido del token)
                    example: "prof_001"
                  codDocumPaciente:
                    type: string
                    description: CI del paciente
                    example: "12345678"
                  estado:
                    type: string
                    description: Estado de la solicitud
                    example: "PENDIENTE"
                  mensaje:
                    type: string
                    description: Mensaje de confirmaci贸n
                    example: "Solicitud de acceso creada exitosamente"
              example:
                solicitudId: 1
                profesionalId: "prof_001"
                codDocumPaciente: "12345678"
                estado: "PENDIENTE"
                mensaje: "Solicitud de acceso creada exitosamente"
        '400':
          description: Error de validaci贸n - campos requeridos faltantes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "codDocumPaciente es requerido"
        '401':
          description: No autenticado o profesional no identificado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Autenticaci贸n requerida"
        '500':
          description: Error interno al crear la solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Error al crear solicitud de acceso"

  /documentos/solicitar-acceso-historia-clinica:
    post:
      summary: Solicitar acceso a toda la historia cl铆nica de un paciente
      description: |
        Permite a un profesional solicitar acceso a **todos los documentos** de un paciente (su historia cl铆nica completa).
        
        Este endpoint es similar a `/documentos/solicitar-acceso`, pero espec铆ficamente dise帽ado para solicitar
        acceso a toda la historia cl铆nica del paciente, no solo a documentos espec铆ficos.
        
        La solicitud se crea con estado `PENDIENTE` y tipo `HISTORIA_CLINICA_COMPLETA`. Debe ser aprobada o rechazada
        por el paciente a trav茅s de los endpoints `/documentos/solicitudes/{id}/aprobar` o `/documentos/solicitudes/{id}/rechazar`.
        
        **Diferencia con `/documentos/solicitar-acceso`**: Este endpoint siempre crea una solicitud para toda la historia cl铆nica,
        mientras que el otro permite especificar documentos o tipos de documentos espec铆ficos.
      operationId: solicitarAccesoHistoriaClinica
      tags:
        - Documentos
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - codDocumPaciente
              properties:
                codDocumPaciente:
                  type: string
                  description: CI o documento de identidad del paciente
                  example: "12345678"
                razonSolicitud:
                  type: string
                  description: Raz贸n por la cual se solicita acceso a la historia cl铆nica completa (opcional)
                  example: "Necesito revisar toda la historia cl铆nica del paciente para una evaluaci贸n completa"
                  nullable: true
                especialidad:
                  type: string
                  description: Especialidad del profesional (opcional, se puede obtener del contexto si no se env铆a)
                  example: "Medicina General"
                  nullable: true
            example:
              codDocumPaciente: "12345678"
              razonSolicitud: "Necesito revisar toda la historia cl铆nica del paciente para una evaluaci贸n completa"
              especialidad: "Medicina General"
      responses:
        '201':
          description: Solicitud de acceso a historia cl铆nica creada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  solicitudId:
                    type: integer
                    format: int64
                    description: ID de la solicitud creada
                    example: 1
                  profesionalId:
                    type: string
                    description: ID del profesional que solicit贸 acceso (obtenido del token)
                    example: "admin_c101"
                  codDocumPaciente:
                    type: string
                    description: CI del paciente
                    example: "12345678"
                  estado:
                    type: string
                    description: Estado de la solicitud
                    example: "PENDIENTE"
                  tipoSolicitud:
                    type: string
                    description: Tipo de solicitud
                    example: "HISTORIA_CLINICA_COMPLETA"
                  mensaje:
                    type: string
                    description: Mensaje de confirmaci贸n
                    example: "Solicitud de acceso a historia cl铆nica creada exitosamente"
              example:
                solicitudId: 1
                profesionalId: "admin_c101"
                codDocumPaciente: "12345678"
                estado: "PENDIENTE"
                tipoSolicitud: "HISTORIA_CLINICA_COMPLETA"
                mensaje: "Solicitud de acceso a historia cl铆nica creada exitosamente"
        '400':
          description: Error de validaci贸n - campos requeridos faltantes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "codDocumPaciente es requerido"
        '401':
          description: No autenticado o profesional no identificado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Autenticaci贸n requerida"
        '500':
          description: Error interno al crear la solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                error: "Error al crear solicitud de acceso"

  /documentos/solicitudes/{id}/aprobar:
    post:
      summary: Aprobar una solicitud de acceso
      description: |
        Aprueba una solicitud de acceso a documentos o historia cl铆nica de un paciente.
        
        Este endpoint permite aprobar solicitudes creadas a trav茅s de `/documentos/solicitar-acceso` o
        `/documentos/solicitar-acceso-historia-clinica`. Una vez aprobada, el profesional puede acceder
        a los documentos seg煤n el alcance de la solicitud.
        
        **Nota**: El servicio de pol铆ticas valida que quien aprueba sea el paciente correspondiente.
        Este endpoint delega la aprobaci贸n al servicio de pol铆ticas.
      operationId: aprobarSolicitud
      tags:
        - Documentos
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID de la solicitud a aprobar
          schema:
            type: integer
            format: int64
            example: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resueltoPor:
                  type: string
                  description: Identificador de quien resuelve la solicitud (opcional)
                  example: "paciente_12345678"
                  nullable: true
                comentario:
                  type: string
                  description: Comentario sobre la aprobaci贸n (opcional)
                  example: "Aprobado por el paciente"
                  nullable: true
            example:
              resueltoPor: "paciente_12345678"
              comentario: "Aprobado por el paciente"
      responses:
        '200':
          description: Solicitud aprobada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  solicitudId:
                    type: integer
                    format: int64
                    description: ID de la solicitud
                    example: 1
                  estado:
                    type: string
                    description: Nuevo estado de la solicitud
                    example: "APROBADA"
                  resueltoPor:
                    type: string
                    description: Quien resolvi贸 la solicitud
                    example: "paciente_12345678"
                  mensaje:
                    type: string
                    description: Mensaje de confirmaci贸n
                    example: "Solicitud aprobada exitosamente"
              example:
                solicitudId: 1
                estado: "APROBADA"
                resueltoPor: "paciente_12345678"
                mensaje: "Solicitud aprobada exitosamente"
        '400':
          description: Error de validaci贸n
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Solicitud no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno al aprobar la solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /documentos/solicitudes/{id}/rechazar:
    post:
      summary: Rechazar una solicitud de acceso
      description: |
        Rechaza una solicitud de acceso a documentos o historia cl铆nica de un paciente.
        
        Este endpoint permite rechazar solicitudes creadas a trav茅s de `/documentos/solicitar-acceso` o
        `/documentos/solicitar-acceso-historia-clinica`. Una vez rechazada, el profesional no podr谩
        acceder a los documentos solicitados.
        
        **Nota**: El servicio de pol铆ticas valida que quien rechaza sea el paciente correspondiente.
        Este endpoint delega el rechazo al servicio de pol铆ticas.
      operationId: rechazarSolicitud
      tags:
        - Documentos
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: ID de la solicitud a rechazar
          schema:
            type: integer
            format: int64
            example: 2
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                resueltoPor:
                  type: string
                  description: Identificador de quien resuelve la solicitud (opcional)
                  example: "paciente_12345678"
                  nullable: true
                comentario:
                  type: string
                  description: Comentario sobre el rechazo (opcional)
                  example: "Rechazado por el paciente"
                  nullable: true
            example:
              resueltoPor: "paciente_12345678"
              comentario: "Rechazado por el paciente"
      responses:
        '200':
          description: Solicitud rechazada exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  solicitudId:
                    type: integer
                    format: int64
                    description: ID de la solicitud
                    example: 2
                  estado:
                    type: string
                    description: Nuevo estado de la solicitud
                    example: "RECHAZADA"
                  resueltoPor:
                    type: string
                    description: Quien resolvi贸 la solicitud
                    example: "paciente_12345678"
                  mensaje:
                    type: string
                    description: Mensaje de confirmaci贸n
                    example: "Solicitud rechazada exitosamente"
              example:
                solicitudId: 2
                estado: "RECHAZADA"
                resueltoPor: "paciente_12345678"
                mensaje: "Solicitud rechazada exitosamente"
        '400':
          description: Error de validaci贸n
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '401':
          description: No autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Solicitud no encontrada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Error interno al rechazar la solicitud
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /profesionales:
    get:
      summary: Listar profesionales
      description: Obtiene la lista de profesionales de salud
      operationId: listarProfesionales
      tags:
        - Profesionales
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de profesionales
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Profesional'
    post:
      summary: Crear profesional
      description: Crea un nuevo profesional de salud
      operationId: crearProfesional
      tags:
        - Profesionales
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProfesionalDTO'
      responses:
        '201':
          description: Profesional creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Profesional'

  /portal/configuracion:
    get:
      summary: Obtener configuraci贸n del portal
      description: Obtiene la configuraci贸n del portal de la cl铆nica
      operationId: obtenerConfiguracionPortal
      tags:
        - Portal
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Configuraci贸n del portal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfiguracionPortal'
    put:
      summary: Actualizar configuraci贸n del portal
      description: Actualiza la configuraci贸n del portal
      operationId: actualizarConfiguracionPortal
      tags:
        - Portal
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfiguracionPortal'
      responses:
        '200':
          description: Configuraci贸n actualizada

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    LoginRequest:
      type: object
      required:
        - nickname
        - password
      properties:
        nickname:
          type: string
        password:
          type: string

    LoginResponse:
      type: object
      properties:
        token:
          type: string
        nickname:
          type: string
        rol:
          type: string

    InitRequest:
      type: object
      required:
        - tenantId
        - nombre
        - rut
      properties:
        tenantId:
          type: string
        nombre:
          type: string
        rut:
          type: string
        colorPrimario:
          type: string
        nombrePortal:
          type: string
        adminEmail:
          type: string

    InitResponse:
      type: object
      properties:
        message:
          type: string
        tenantId:
          type: string
        schemaName:
          type: string
        clinicName:
          type: string
        adminNickname:
          type: string
        activationToken:
          type: string

    CrearDocumentoRequest:
      type: object
      required:
        - contenido
        - documentoIdPaciente
      properties:
        contenido:
          type: string
        documentoIdPaciente:
          type: string
        tenantId:
          type: string
        documentoId:
          type: string
          description: Si no se proporciona, se genera autom谩ticamente
        especialidad:
          type: string
        formato:
          type: string
        autor:
          type: string
        titulo:
          type: string
        languageCode:
          type: string
        breakingTheGlass:
          type: boolean
        descripcion:
          type: string
        datosPatronimicos:
          type: object
          properties:
            nombre:
              type: string
            apellido:
              type: string
            fechaNacimiento:
              type: string
              format: date

    CrearDocumentoResponse:
      type: object
      properties:
        documentoId:
          type: string
        mongoId:
          type: string
        urlAcceso:
          type: string
        documentoIdPaciente:
          type: string

    Profesional:
      type: object
      properties:
        id:
          type: integer
        nombre:
          type: string
        apellido:
          type: string
        especialidad:
          type: string

    ProfesionalDTO:
      type: object
      required:
        - nombre
        - apellido
      properties:
        nombre:
          type: string
        apellido:
          type: string
        especialidad:
          type: string

    ConfiguracionPortal:
      type: object
      properties:
        colorPrimario:
          type: string
        nombrePortal:
          type: string

    MetadatosDocumento:
      type: object
      description: |
        Metadatos completos de un documento cl铆nico. 
        Incluye informaci贸n de identificaci贸n, autor铆a, formato y acceso.
      properties:
        documentoId:
          type: string
          description: ID 煤nico del documento
          example: "dbe1515b-b56d-4f46-8b61-1299c88f5d2e"
        documentoIdPaciente:
          type: string
          description: CI o documento de identidad del paciente
          example: "12345678"
        tenantId:
          type: string
          description: ID del tenant (cl铆nica/prestador) que gener贸 el documento
          example: "101"
        especialidad:
          type: string
          description: Especialidad m茅dica
          example: "Medicina General"
        formato:
          type: string
          description: MIME type del documento
          example: "text/plain"
        autor:
          type: string
          description: Nombre del profesional o sistema que gener贸 el documento
          example: "Dr. Juan P茅rez"
        titulo:
          type: string
          description: T铆tulo visible del documento
          example: "Consulta M茅dica"
        languageCode:
          type: string
          description: C贸digo de idioma del contenido
          example: "es"
        breakingTheGlass:
          type: boolean
          description: Indica si se rompi贸 el vidrio (acceso de emergencia)
          example: false
        urlAcceso:
          type: string
          description: URL para acceder al contenido completo del documento en el componente perif茅rico
          example: "http://127.0.0.1:8080/hcen-web/api/documentos/690bb94df439e34986bf1ab7"
        fechaCreacion:
          type: string
          format: date-time
          description: Fecha/hora de creaci贸n del documento
          example: "2025-01-15T10:30:00"
        fechaRegistro:
          type: string
          format: date-time
          description: Fecha/hora de registro en HCEN
          example: "2025-01-15T10:31:00"
        aaPrestador:
          type: string
          description: Identificador del Prestador (AA)
          nullable: true
          example: "AA123456"
        emisorDocumentoOID:
          type: string
          description: OID del emisor del documento
          nullable: true
          example: "1.2.840.113619.2.1.1.1"
        hashDocumento:
          type: string
          description: Hash del documento para verificar integridad
          nullable: true
          example: "a1b2c3d4e5f6..."
        descripcion:
          type: string
          description: Descripci贸n libre o resumen del documento
          nullable: true
          example: "Consulta de rutina"
      required:
        - documentoId
        - documentoIdPaciente

    Error:
      type: object
      properties:
        error:
          type: string
        detail:
          type: string

tags:
  - name: Health
    description: Endpoints de salud del servicio
  - name: Autenticaci贸n
    description: Endpoints de autenticaci贸n y autorizaci贸n
  - name: Configuraci贸n
    description: Configuraci贸n de tenants y usuarios
  - name: Documentos
    description: Gesti贸n de documentos cl铆nicos
  - name: Profesionales
    description: Gesti贸n de profesionales de salud
  - name: Portal
    description: Configuraci贸n del portal de la cl铆nica

