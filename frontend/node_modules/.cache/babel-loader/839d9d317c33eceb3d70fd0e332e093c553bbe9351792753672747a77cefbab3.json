{"ast":null,"code":"import React,{useEffect,useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ClinicAdmin(){const[session,setSession]=useState(null);const[loading,setLoading]=useState(false);const[payload,setPayload]=useState('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }');const backendBase=process.env.REACT_APP_BACKEND_URL||'http://localhost:8080/nodo-periferico';useEffect(()=>{checkSession();},[]);async function checkSession(){try{const res=await fetch(\"\".concat(backendBase,\"/api/auth/session\"),{credentials:'include'});if(res.ok){const json=await res.json();setSession(json);}else{setSession(null);}}catch(e){console.error(e);setSession(null);}}async function doLogout(){await fetch(\"\".concat(backendBase,\"/api/auth/logout\"),{credentials:'include'});setSession(null);}async function sendAlta(){setLoading(true);try{const body={payload};const res=await fetch(\"\".concat(backendBase,\"/api/clinica/alta\"),{method:'POST',credentials:'include',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});if(res.status===202){alert('Alta enviada (202 Accepted).');}else{const t=await res.text();alert('Error: '+res.status+' '+t);}}catch(e){console.error(e);alert('Error al enviar');}setLoading(false);}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sesi\\xF3n\"}),session&&session.authenticated?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Autenticado como: \",/*#__PURE__*/_jsx(\"strong\",{children:session.nombre||session.username})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button-secondary\",onClick:doLogout,children:\"Cerrar sesi\\xF3n\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"No autenticado. Para pruebas, inicia sesi\\xF3n contra el endpoint central o usa mocks.\"}),/*#__PURE__*/_jsx(\"a\",{className:\"link\",href:\"\".concat(backendBase,\"/auth\"),children:\"Abrir login\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{height:12}}),/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Alta de Cl\\xEDnica\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"input\",rows:6,value:payload,onChange:e=>setPayload(e.target.value)})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"button-primary\",onClick:sendAlta,disabled:loading,children:loading?'Enviando...':'Enviar Alta'}),/*#__PURE__*/_jsx(\"button\",{className:\"button-secondary\",onClick:()=>setPayload('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }'),children:\"Reset\"})]})]})]});}export default ClinicAdmin;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","ClinicAdmin","session","setSession","loading","setLoading","payload","setPayload","backendBase","process","env","REACT_APP_BACKEND_URL","checkSession","res","fetch","concat","credentials","ok","json","e","console","error","doLogout","sendAlta","body","method","headers","JSON","stringify","status","alert","t","text","children","className","authenticated","nombre","username","onClick","href","style","height","rows","value","onChange","target","display","gap","disabled"],"sources":["C:/Users/CaroH/Documents/fing/TSE/lab/componente-periferico/frontend/src/components/ClinicAdmin.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nfunction ClinicAdmin(){\r\n  const [session, setSession] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [payload, setPayload] = useState('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }');\r\n  const backendBase = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080/nodo-periferico';\r\n\r\n  useEffect(()=>{ checkSession(); },[]);\r\n\r\n  async function checkSession(){\r\n    try{\r\n      const res = await fetch(`${backendBase}/api/auth/session`, { credentials: 'include' });\r\n      if(res.ok){\r\n        const json = await res.json();\r\n        setSession(json);\r\n      } else {\r\n        setSession(null);\r\n      }\r\n    }catch(e){ console.error(e); setSession(null); }\r\n  }\r\n\r\n  async function doLogout(){\r\n    await fetch(`${backendBase}/api/auth/logout`, { credentials: 'include' });\r\n    setSession(null);\r\n  }\r\n\r\n  async function sendAlta(){\r\n    setLoading(true);\r\n    try{\r\n      const body = { payload };\r\n      const res = await fetch(`${backendBase}/api/clinica/alta`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(body)\r\n      });\r\n      if(res.status === 202){\r\n        alert('Alta enviada (202 Accepted).');\r\n      } else {\r\n        const t = await res.text();\r\n        alert('Error: ' + res.status + ' ' + t);\r\n      }\r\n    }catch(e){ console.error(e); alert('Error al enviar'); }\r\n    setLoading(false);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"card\">\r\n        <h2>Sesión</h2>\r\n        {session && session.authenticated ? (\r\n          <div>\r\n            <p>Autenticado como: <strong>{session.nombre || session.username}</strong></p>\r\n            <button className=\"button-secondary\" onClick={doLogout}>Cerrar sesión</button>\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            <p>No autenticado. Para pruebas, inicia sesión contra el endpoint central o usa mocks.</p>\r\n            <a className=\"link\" href={`${backendBase}/auth`}>Abrir login</a>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div style={{height:12}} />\r\n\r\n      <div className=\"card\">\r\n        <h2>Alta de Clínica</h2>\r\n        <div className=\"form-row\">\r\n          <textarea className=\"input\" rows={6} value={payload} onChange={(e)=>setPayload(e.target.value)} />\r\n        </div>\r\n        <div style={{display:'flex', gap:8}}>\r\n          <button className=\"button-primary\" onClick={sendAlta} disabled={loading}>{loading ? 'Enviando...':'Enviar Alta'}</button>\r\n          <button className=\"button-secondary\" onClick={()=>setPayload('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }')}>Reset</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ClinicAdmin;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}