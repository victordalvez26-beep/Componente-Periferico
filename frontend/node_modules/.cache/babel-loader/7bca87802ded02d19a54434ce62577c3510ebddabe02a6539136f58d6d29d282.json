{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\CaroH\\\\Documents\\\\fing\\\\TSE\\\\lab\\\\componente-periferico\\\\frontend\\\\src\\\\components\\\\ClinicAdmin.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ClinicAdmin() {\n  _s();\n  const [session, setSession] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [payload, setPayload] = useState('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }');\n  // Use environment override if provided; otherwise use relative path so CRA proxy (package.json -> proxy)\n  // or production reverse proxy can route correctly. This avoids hardcoded port 8080.\n  const backendBase = process.env.REACT_APP_BACKEND_URL || '/nodo-periferico';\n\n  // login form state\n  const [username, setUsername] = useState('admin');\n  const [password, setPassword] = useState('admin');\n\n  // nodo status\n  const [nodoId, setNodoId] = useState('1');\n  const [nodoInfo, setNodoInfo] = useState(null);\n  const [nodoLoading, setNodoLoading] = useState(false);\n  // integration status\n  const [integration, setIntegration] = useState({\n    integrated: false,\n    matchedNodo: null,\n    lastCheck: null\n  });\n  const [integrationLoading, setIntegrationLoading] = useState(false);\n  // professional workflow\n  const [patients, setPatients] = useState([]);\n  const [selectedPatient, setSelectedPatient] = useState(null);\n  const [patientDocs, setPatientDocs] = useState([]);\n  const [docPermissions, setDocPermissions] = useState({});\n  // multitenant: clinic id configured in this instance\n  const [clinicId, setClinicId] = useState(localStorage.getItem('clinicId') || 'clinic-1');\n  useEffect(() => {\n    checkSession();\n  }, []);\n\n  // fetch integration status on load\n  // Fetch integration status on mount and whenever clinicId changes\n  useEffect(() => {\n    fetchIntegrationStatus();\n  }, [clinicId]);\n  async function fetchIntegrationStatus() {\n    setIntegrationLoading(true);\n    try {\n      // cache-busting param to ensure browser/dev-server proxies don't return stale results\n      const clinic = encodeURIComponent(localStorage.getItem('clinicId') || 'clinic-1');\n      const ts = Date.now();\n      const res = await fetch(`${backendBase}/api/integration/status?clinicId=${clinic}&_=${ts}`, {\n        credentials: 'include',\n        cache: 'no-store'\n      });\n      if (res.ok) {\n        const j = await res.json();\n        setIntegration(j);\n      }\n    } catch (e) {\n      console.error('Error fetching integration status', e);\n    }\n    setIntegrationLoading(false);\n  }\n  async function checkSession() {\n    try {\n      const res = await fetch(`${backendBase}/api/auth/session`, {\n        credentials: 'include'\n      });\n      if (res.ok) {\n        const json = await res.json();\n        setSession(json);\n      } else {\n        setSession(null);\n      }\n    } catch (e) {\n      console.error(e);\n      setSession(null);\n    }\n  }\n\n  // if logged in as PROFESSIONAL, load patients\n  useEffect(() => {\n    if (session && session.authenticated && Array.isArray(session.roles) && session.roles.includes('PROFESIONAL')) {\n      loadPatients();\n    }\n  }, [session]);\n\n  // search term for patients\n  const [patientQuery, setPatientQuery] = useState('');\n  async function loadPatients(q) {\n    try {\n      // The backend exposes /api/profesional/pacientes/{username}?clinicId=...\n      const username = session ? session.username || 'prof1' : 'prof1';\n      const clinic = encodeURIComponent(localStorage.getItem('clinicId') || 'clinic-1');\n      const qparam = q ? `&q=${encodeURIComponent(q)}` : '';\n      const res = await fetch(`${backendBase}/api/profesional/pacientes/${encodeURIComponent(username)}?clinicId=${clinic}${qparam}`, {\n        credentials: 'include'\n      });\n      if (res.ok) {\n        const j = await res.json();\n        setPatients(Array.isArray(j) ? j : []);\n      }\n    } catch (e) {\n      console.error('Error loading patients', e);\n    }\n  }\n  async function selectPatient(p) {\n    setSelectedPatient(p);\n    setPatientDocs([]);\n    setDocPermissions({});\n    try {\n      // call backend proxy that will call RNDC and politicas\n      const profId = session ? session.username : null;\n      const res = await fetch(`${backendBase}/api/profesional/paciente/${encodeURIComponent(p.ci)}/documentos?profesionalId=${encodeURIComponent(profId)}`, {\n        credentials: 'include'\n      });\n      if (res.ok) {\n        const j = await res.json();\n        setPatientDocs(Array.isArray(j) ? j : []);\n        // fetch per-document permissions for professional view\n        if (profId && Array.isArray(j) && j.length > 0) {\n          fetchDocPermissions(profId, p, j);\n        }\n      } else {\n        const t = await res.text().catch(() => null);\n        alert('Error cargando documentos: ' + res.status + ' ' + t);\n      }\n    } catch (e) {\n      console.error('Error fetching docs', e);\n      alert('Error al cargar documentos');\n    }\n  }\n\n  // helper to build a stable key for a document\n  function docKey(d, idx) {\n    return d.referencia || d.codDocumPaciente || d.metadataId || d.filename || d.uriDocumento || idx;\n  }\n  async function fetchDocPermissions(profId, patient, docs) {\n    const perms = {};\n    await Promise.all(docs.map(async (d, idx) => {\n      const key = docKey(d, idx);\n      try {\n        const q = `${backendBase}/api/profesional/verificar?profesionalId=${encodeURIComponent(profId)}&pacienteCI=${encodeURIComponent(patient.ci)}&tipoDoc=${encodeURIComponent(d.tipoDocumento || '')}`;\n        const r = await fetch(q, {\n          credentials: 'include'\n        });\n        if (r.ok) {\n          const j = await r.json();\n          // REST returns { tienePermiso: true/false }\n          perms[key] = !!j.tienePermiso;\n        } else {\n          perms[key] = false;\n        }\n      } catch (e) {\n        perms[key] = false;\n      }\n    }));\n    setDocPermissions(perms);\n  }\n  async function solicitarAcceso(doc) {\n    try {\n      const body = {\n        codDocumPaciente: selectedPatient.ci,\n        tipoDocumento: doc.tipoDocumento,\n        profesionalSolicitante: session ? session.username : 'prof1'\n      };\n      const res = await fetch(`${backendBase}/api/profesional/solicitudes`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n      if (res.ok) alert('Solicitud enviada');else {\n        const t = await res.text().catch(() => null);\n        alert('Error: ' + res.status + ' ' + t);\n      }\n    } catch (e) {\n      console.error(e);\n      alert('Error al enviar solicitud');\n    }\n  }\n  async function doLogin(e) {\n    e && e.preventDefault();\n    try {\n      const res = await fetch(`${backendBase}/api/auth/login`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username,\n          password\n        })\n      });\n      if (res.ok) {\n        const j = await res.json();\n        setSession({\n          authenticated: true,\n          nombre: j.nombre || j.username,\n          username: j.username\n        });\n        alert('Login OK como ' + (j.nombre || j.username));\n      } else if (res.status === 401) {\n        alert('Credenciales inválidas');\n      } else {\n        const txt = await res.text().catch(() => null);\n        alert('Error al loguear: ' + res.status + ' ' + txt);\n      }\n    } catch (err) {\n      console.error(err);\n      alert('Error al hacer login');\n    }\n  }\n  function onSearchPatients() {\n    loadPatients(patientQuery);\n  }\n  async function fetchNodo() {\n    if (!nodoId) return;\n    setNodoLoading(true);\n    try {\n      const res = await fetch(`${backendBase}/api/nodos/${encodeURIComponent(nodoId)}`, {\n        credentials: 'include'\n      });\n      if (res.ok) {\n        const j = await res.json();\n        // show node only if matches clinicId (simple multitenant check); assume nodo DTO has 'clinicId'\n        if (j.clinicId && j.clinicId !== clinicId) {\n          setNodoInfo({\n            notOwned: true\n          });\n        } else {\n          setNodoInfo(j);\n        }\n      } else if (res.status === 404) {\n        setNodoInfo({\n          notFound: true\n        });\n      } else {\n        const t = await res.text().catch(() => null);\n        setNodoInfo({\n          error: `${res.status} ${t}`\n        });\n      }\n    } catch (e) {\n      console.error(e);\n      setNodoInfo({\n        error: e.message\n      });\n    }\n    setNodoLoading(false);\n  }\n\n  // allow manual refresh from UI\n  function refreshIntegration() {\n    fetchIntegrationStatus();\n  }\n\n  // test-pdf download removed — central/Nodo debe exponer la descarga\n\n  async function doLogout() {\n    await fetch(`${backendBase}/api/auth/logout`, {\n      credentials: 'include'\n    });\n    setSession(null);\n  }\n  async function sendAlta() {\n    setLoading(true);\n    try {\n      const body = {\n        payload\n      };\n      const res = await fetch(`${backendBase}/api/clinica/alta`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      });\n      if (res.status === 202) {\n        alert('Alta enviada (202 Accepted).');\n      } else {\n        const t = await res.text();\n        alert('Error: ' + res.status + ' ' + t);\n      }\n    } catch (e) {\n      console.error(e);\n      alert('Error al enviar');\n    }\n    setLoading(false);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Sesi\\xF3n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 8\n        },\n        children: [integrationLoading ? /*#__PURE__*/_jsxDEV(\"small\", {\n          children: \"Comprobando integraci\\xF3n...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Integraci\\xF3n con Nodo Central:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this), \" \", integration && integration.integrated ? /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: 'green'\n            },\n            children: \"Integrado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 103\n          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: 'red'\n            },\n            children: \"No integrado\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 152\n          }, this), \" \", integration.matchedNodo ? ` — nodo: ${integration.matchedNodo}` : '', /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button-secondary\",\n            style: {\n              marginLeft: 12\n            },\n            onClick: refreshIntegration,\n            children: \"Refrescar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"small\", {\n            children: [\"Debug: clinicId = \", /*#__PURE__*/_jsxDEV(\"code\", {\n              children: localStorage.getItem('clinicId') || 'clinic-1'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 38\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n            style: {\n              maxHeight: 120,\n              overflow: 'auto',\n              background: '#f6f6f6',\n              padding: 8\n            },\n            children: JSON.stringify(integration, null, 2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this), session && session.authenticated ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Autenticado como: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: session.nombre || session.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-secondary\",\n          onClick: doLogout,\n          children: \"Cerrar sesi\\xF3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"No autenticado. Para pruebas, use el login de test a continuaci\\xF3n (usuario: \", /*#__PURE__*/_jsxDEV(\"code\", {\n            children: \"admin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 92\n          }, this), \" / pass: \", /*#__PURE__*/_jsxDEV(\"code\", {\n            children: \"admin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 119\n          }, this), \").\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: doLogin,\n          style: {\n            display: 'flex',\n            gap: 8,\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"input\",\n            value: username,\n            onChange: e => setUsername(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"input\",\n            type: \"password\",\n            value: password,\n            onChange: e => setPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button-primary\",\n            type: \"submit\",\n            children: \"Login (test)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), session && session.authenticated && Array.isArray(session.roles) && session.roles.includes('PROFESIONAL') ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Panel Profesional\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"input\",\n          placeholder: \"Buscar paciente por nombre\",\n          value: patientQuery,\n          onChange: e => setPatientQuery(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-primary\",\n          onClick: onSearchPatients,\n          children: \"Buscar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-secondary\",\n          onClick: () => {\n            setPatientQuery('');\n            loadPatients();\n          },\n          children: \"Limpiar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Pacientes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this), patients.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"No hay pacientes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 38\n        }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: patients.map((p, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [p.nombre, \" (\", p.ci, \") \", /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"button-secondary\",\n              onClick: () => selectPatient(p),\n              children: \"Ver documentos\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 41\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 15\n        }, this), selectedPatient && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 12\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Documentos de \", selectedPatient.nombre, \" (\", selectedPatient.ci, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 17\n          }, this), patientDocs.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"No se encontraron documentos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 45\n          }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: patientDocs.map((d, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [d.tipoDocumento, \" - \", d.formatoDocumento, /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'inline-block',\n                  marginLeft: 8\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"a\", {\n                  className: \"link\",\n                  href: d.uriDocumento || '#',\n                  target: \"_blank\",\n                  rel: \"noreferrer\",\n                  children: \"Ver/Descargar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"button-secondary\",\n                  style: {\n                    marginLeft: 8\n                  },\n                  onClick: () => solicitarAcceso(d),\n                  children: \"Solicitar acceso\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 25\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 23\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 229,\n    columnNumber: 5\n  }, this);\n}\n_s(ClinicAdmin, \"m5T6A2/MOMWgJlDf//jm1tZe4pg=\");\n_c = ClinicAdmin;\nexport default ClinicAdmin;\nvar _c;\n$RefreshReg$(_c, \"ClinicAdmin\");","map":{"version":3,"names":["React","useEffect","useState","jsxDEV","_jsxDEV","ClinicAdmin","_s","session","setSession","loading","setLoading","payload","setPayload","backendBase","process","env","REACT_APP_BACKEND_URL","username","setUsername","password","setPassword","nodoId","setNodoId","nodoInfo","setNodoInfo","nodoLoading","setNodoLoading","integration","setIntegration","integrated","matchedNodo","lastCheck","integrationLoading","setIntegrationLoading","patients","setPatients","selectedPatient","setSelectedPatient","patientDocs","setPatientDocs","docPermissions","setDocPermissions","clinicId","setClinicId","localStorage","getItem","checkSession","fetchIntegrationStatus","clinic","encodeURIComponent","ts","Date","now","res","fetch","credentials","cache","ok","j","json","e","console","error","authenticated","Array","isArray","roles","includes","loadPatients","patientQuery","setPatientQuery","q","qparam","selectPatient","p","profId","ci","length","fetchDocPermissions","t","text","catch","alert","status","docKey","d","idx","referencia","codDocumPaciente","metadataId","filename","uriDocumento","patient","docs","perms","Promise","all","map","key","tipoDocumento","r","tienePermiso","solicitarAcceso","doc","body","profesionalSolicitante","method","headers","JSON","stringify","doLogin","preventDefault","nombre","txt","err","onSearchPatients","fetchNodo","notOwned","notFound","message","refreshIntegration","doLogout","sendAlta","children","className","fileName","_jsxFileName","lineNumber","columnNumber","style","marginBottom","color","marginLeft","onClick","marginTop","maxHeight","overflow","background","padding","onSubmit","display","gap","alignItems","value","onChange","target","type","placeholder","i","formatoDocumento","href","rel","_c","$RefreshReg$"],"sources":["C:/Users/CaroH/Documents/fing/TSE/lab/componente-periferico/frontend/src/components/ClinicAdmin.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nfunction ClinicAdmin(){\r\n  const [session, setSession] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [payload, setPayload] = useState('{ \"clinic\": \"Mi Clinica\", \"address\": \"Av. Siempreviva 123\" }');\r\n  // Use environment override if provided; otherwise use relative path so CRA proxy (package.json -> proxy)\r\n  // or production reverse proxy can route correctly. This avoids hardcoded port 8080.\r\n  const backendBase = process.env.REACT_APP_BACKEND_URL || '/nodo-periferico';\r\n\r\n  // login form state\r\n  const [username, setUsername] = useState('admin');\r\n  const [password, setPassword] = useState('admin');\r\n\r\n  // nodo status\r\n  const [nodoId, setNodoId] = useState('1');\r\n  const [nodoInfo, setNodoInfo] = useState(null);\r\n  const [nodoLoading, setNodoLoading] = useState(false);\r\n  // integration status\r\n  const [integration, setIntegration] = useState({ integrated: false, matchedNodo: null, lastCheck: null });\r\n  const [integrationLoading, setIntegrationLoading] = useState(false);\r\n  // professional workflow\r\n  const [patients, setPatients] = useState([]);\r\n  const [selectedPatient, setSelectedPatient] = useState(null);\r\n  const [patientDocs, setPatientDocs] = useState([]);\r\n  const [docPermissions, setDocPermissions] = useState({});\r\n  // multitenant: clinic id configured in this instance\r\n  const [clinicId, setClinicId] = useState(localStorage.getItem('clinicId') || 'clinic-1');\r\n\r\n  useEffect(()=>{ checkSession(); },[]);\r\n\r\n  // fetch integration status on load\r\n  // Fetch integration status on mount and whenever clinicId changes\r\n  useEffect(()=>{ fetchIntegrationStatus(); }, [clinicId]);\r\n\r\n  async function fetchIntegrationStatus(){\r\n    setIntegrationLoading(true);\r\n    try{\r\n      // cache-busting param to ensure browser/dev-server proxies don't return stale results\r\n      const clinic = encodeURIComponent(localStorage.getItem('clinicId') || 'clinic-1');\r\n      const ts = Date.now();\r\n      const res = await fetch(`${backendBase}/api/integration/status?clinicId=${clinic}&_=${ts}`, { credentials: 'include', cache: 'no-store' });\r\n      if(res.ok){\r\n        const j = await res.json();\r\n        setIntegration(j);\r\n      }\r\n    }catch(e){ console.error('Error fetching integration status', e); }\r\n    setIntegrationLoading(false);\r\n  }\r\n\r\n  async function checkSession(){\r\n    try{\r\n      const res = await fetch(`${backendBase}/api/auth/session`, { credentials: 'include' });\r\n      if(res.ok){\r\n        const json = await res.json();\r\n        setSession(json);\r\n      } else {\r\n        setSession(null);\r\n      }\r\n    }catch(e){ console.error(e); setSession(null); }\r\n  }\r\n\r\n  // if logged in as PROFESSIONAL, load patients\r\n  useEffect(()=>{\r\n    if(session && session.authenticated && Array.isArray(session.roles) && session.roles.includes('PROFESIONAL')){\r\n      loadPatients();\r\n    }\r\n  }, [session]);\r\n\r\n  // search term for patients\r\n  const [patientQuery, setPatientQuery] = useState('');\r\n\r\n  async function loadPatients(q){\r\n    try{\r\n      // The backend exposes /api/profesional/pacientes/{username}?clinicId=...\r\n      const username = session ? (session.username || 'prof1') : 'prof1';\r\n      const clinic = encodeURIComponent(localStorage.getItem('clinicId') || 'clinic-1');\r\n      const qparam = q ? `&q=${encodeURIComponent(q)}` : '';\r\n      const res = await fetch(`${backendBase}/api/profesional/pacientes/${encodeURIComponent(username)}?clinicId=${clinic}${qparam}`, { credentials: 'include' });\r\n      if(res.ok){\r\n        const j = await res.json();\r\n        setPatients(Array.isArray(j) ? j : []);\r\n      }\r\n    }catch(e){ console.error('Error loading patients', e); }\r\n  }\r\n\r\n  async function selectPatient(p){\r\n    setSelectedPatient(p);\r\n    setPatientDocs([]);\r\n    setDocPermissions({});\r\n    try{\r\n      // call backend proxy that will call RNDC and politicas\r\n      const profId = session ? session.username : null;\r\n      const res = await fetch(`${backendBase}/api/profesional/paciente/${encodeURIComponent(p.ci)}/documentos?profesionalId=${encodeURIComponent(profId)}`, { credentials: 'include' });\r\n      if(res.ok){\r\n        const j = await res.json();\r\n        setPatientDocs(Array.isArray(j) ? j : []);\r\n        // fetch per-document permissions for professional view\r\n        if(profId && Array.isArray(j) && j.length>0){\r\n          fetchDocPermissions(profId, p, j);\r\n        }\r\n      } else {\r\n        const t = await res.text().catch(()=>null);\r\n        alert('Error cargando documentos: ' + res.status + ' ' + t);\r\n      }\r\n    }catch(e){ console.error('Error fetching docs', e); alert('Error al cargar documentos'); }\r\n  }\r\n\r\n  // helper to build a stable key for a document\r\n  function docKey(d, idx){\r\n    return d.referencia || d.codDocumPaciente || d.metadataId || d.filename || d.uriDocumento || idx;\r\n  }\r\n\r\n  async function fetchDocPermissions(profId, patient, docs){\r\n    const perms = {};\r\n    await Promise.all(docs.map(async (d, idx) => {\r\n      const key = docKey(d, idx);\r\n      try{\r\n        const q = `${backendBase}/api/profesional/verificar?profesionalId=${encodeURIComponent(profId)}&pacienteCI=${encodeURIComponent(patient.ci)}&tipoDoc=${encodeURIComponent(d.tipoDocumento||'')}`;\r\n        const r = await fetch(q, { credentials: 'include' });\r\n        if(r.ok){\r\n          const j = await r.json();\r\n          // REST returns { tienePermiso: true/false }\r\n          perms[key] = !!j.tienePermiso;\r\n        } else {\r\n          perms[key] = false;\r\n        }\r\n      }catch(e){ perms[key] = false; }\r\n    }));\r\n    setDocPermissions(perms);\r\n  }\r\n\r\n  async function solicitarAcceso(doc){\r\n    try{\r\n      const body = {\r\n        codDocumPaciente: selectedPatient.ci,\r\n        tipoDocumento: doc.tipoDocumento,\r\n        profesionalSolicitante: session ? session.username : 'prof1'\r\n      };\r\n      const res = await fetch(`${backendBase}/api/profesional/solicitudes`, {\r\n        method: 'POST', credentials: 'include', headers: {'Content-Type':'application/json'}, body: JSON.stringify(body)\r\n      });\r\n      if(res.ok) alert('Solicitud enviada'); else { const t = await res.text().catch(()=>null); alert('Error: '+res.status+' '+t); }\r\n    }catch(e){ console.error(e); alert('Error al enviar solicitud'); }\r\n  }\r\n\r\n  async function doLogin(e){\r\n    e && e.preventDefault();\r\n    try{\r\n      const res = await fetch(`${backendBase}/api/auth/login`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type':'application/json' },\r\n        body: JSON.stringify({ username, password })\r\n      });\r\n      if(res.ok){\r\n        const j = await res.json();\r\n        setSession({ authenticated: true, nombre: j.nombre || j.username, username: j.username });\r\n        alert('Login OK como ' + (j.nombre || j.username));\r\n      } else if (res.status === 401) {\r\n        alert('Credenciales inválidas');\r\n      } else {\r\n        const txt = await res.text().catch(()=>null);\r\n        alert('Error al loguear: ' + res.status + ' ' + txt);\r\n      }\r\n    }catch(err){ console.error(err); alert('Error al hacer login'); }\r\n  }\r\n\r\n  function onSearchPatients(){\r\n    loadPatients(patientQuery);\r\n  }\r\n\r\n  async function fetchNodo(){\r\n    if(!nodoId) return;\r\n    setNodoLoading(true);\r\n    try{\r\n      const res = await fetch(`${backendBase}/api/nodos/${encodeURIComponent(nodoId)}`, { credentials: 'include' });\r\n      if(res.ok){\r\n        const j = await res.json();\r\n        // show node only if matches clinicId (simple multitenant check); assume nodo DTO has 'clinicId'\r\n        if (j.clinicId && j.clinicId !== clinicId) {\r\n          setNodoInfo({ notOwned: true });\r\n        } else {\r\n          setNodoInfo(j);\r\n        }\r\n      } else if (res.status === 404){\r\n        setNodoInfo({ notFound: true });\r\n      } else {\r\n        const t = await res.text().catch(()=>null);\r\n        setNodoInfo({ error: `${res.status} ${t}` });\r\n      }\r\n    }catch(e){ console.error(e); setNodoInfo({ error: e.message }); }\r\n    setNodoLoading(false);\r\n  }\r\n\r\n  // allow manual refresh from UI\r\n  function refreshIntegration(){\r\n    fetchIntegrationStatus();\r\n  }\r\n\r\n  // test-pdf download removed — central/Nodo debe exponer la descarga\r\n\r\n  async function doLogout(){\r\n    await fetch(`${backendBase}/api/auth/logout`, { credentials: 'include' });\r\n    setSession(null);\r\n  }\r\n\r\n  async function sendAlta(){\r\n    setLoading(true);\r\n    try{\r\n      const body = { payload };\r\n      const res = await fetch(`${backendBase}/api/clinica/alta`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(body)\r\n      });\r\n      if(res.status === 202){\r\n        alert('Alta enviada (202 Accepted).');\r\n      } else {\r\n        const t = await res.text();\r\n        alert('Error: ' + res.status + ' ' + t);\r\n      }\r\n    }catch(e){ console.error(e); alert('Error al enviar'); }\r\n    setLoading(false);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"card\">\r\n        <h2>Sesión</h2>\r\n        <div style={{marginBottom:8}}>\r\n          {integrationLoading ? (\r\n            <small>Comprobando integración...</small>\r\n          ) : (\r\n            <div>\r\n              <strong>Integración con Nodo Central:</strong> {integration && integration.integrated ? <span style={{color:'green'}}>Integrado</span> : <span style={{color:'red'}}>No integrado</span>} {integration.matchedNodo ? ` — nodo: ${integration.matchedNodo}` : ''}\r\n              <button className=\"button-secondary\" style={{marginLeft:12}} onClick={refreshIntegration}>Refrescar</button>\r\n            </div>\r\n          )}\r\n          {/* Debug info: show clinicId and raw integration object to help diagnose stale UI */}\r\n          <div style={{marginTop:8}}>\r\n            <small>Debug: clinicId = <code>{localStorage.getItem('clinicId') || 'clinic-1'}</code></small>\r\n            <pre style={{maxHeight:120, overflow:'auto', background:'#f6f6f6', padding:8}}>{JSON.stringify(integration, null, 2)}</pre>\r\n          </div>\r\n        </div>\r\n        {session && session.authenticated ? (\r\n          <div>\r\n            <p>Autenticado como: <strong>{session.nombre || session.username}</strong></p>\r\n            <button className=\"button-secondary\" onClick={doLogout}>Cerrar sesión</button>\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            <p>No autenticado. Para pruebas, use el login de test a continuación (usuario: <code>admin</code> / pass: <code>admin</code>).</p>\r\n            <form onSubmit={doLogin} style={{display:'flex', gap:8, alignItems:'center'}}>\r\n              <input className=\"input\" value={username} onChange={(e)=>setUsername(e.target.value)} />\r\n              <input className=\"input\" type=\"password\" value={password} onChange={(e)=>setPassword(e.target.value)} />\r\n              <button className=\"button-primary\" type=\"submit\">Login (test)</button>\r\n            </form>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Simple login-first flow and professional panel */}\r\n      {session && session.authenticated && Array.isArray(session.roles) && session.roles.includes('PROFESIONAL') ? (\r\n        <div className=\"card\">\r\n          <h2>Panel Profesional</h2>\r\n          <div style={{display:'flex', gap:8, alignItems:'center'}}>\r\n            <input className=\"input\" placeholder=\"Buscar paciente por nombre\" value={patientQuery} onChange={(e)=>setPatientQuery(e.target.value)} />\r\n            <button className=\"button-primary\" onClick={onSearchPatients}>Buscar</button>\r\n            <button className=\"button-secondary\" onClick={()=>{ setPatientQuery(''); loadPatients(); }}>Limpiar</button>\r\n          </div>\r\n          <div style={{marginTop:12}}>\r\n            <h3>Pacientes</h3>\r\n            {patients.length === 0 ? <div>No hay pacientes</div> : (\r\n              <ul>\r\n                {patients.map((p, i) => (\r\n                  <li key={i}>\r\n                    {p.nombre} ({p.ci}) <button className=\"button-secondary\" onClick={()=>selectPatient(p)}>Ver documentos</button>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            )}\r\n\r\n            {selectedPatient && (\r\n              <div style={{marginTop:12}}>\r\n                <h4>Documentos de {selectedPatient.nombre} ({selectedPatient.ci})</h4>\r\n                {patientDocs.length === 0 ? <div>No se encontraron documentos</div> : (\r\n                  <ul>\r\n                    {patientDocs.map((d,idx) => (\r\n                      <li key={idx}>\r\n                        {d.tipoDocumento} - {d.formatoDocumento}\r\n                        <div style={{display:'inline-block', marginLeft:8}}>\r\n                          <a className=\"link\" href={d.uriDocumento || '#'} target=\"_blank\" rel=\"noreferrer\">Ver/Descargar</a>\r\n                          <button className=\"button-secondary\" style={{marginLeft:8}} onClick={()=>solicitarAcceso(d)}>Solicitar acceso</button>\r\n                        </div>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {/* Removed clinic configuration and nodo alta UI — handled in backend for this app */}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ClinicAdmin;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnD,SAASC,WAAWA,CAAA,EAAE;EAAAC,EAAA;EACpB,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACS,OAAO,EAAEC,UAAU,CAAC,GAAGV,QAAQ,CAAC,8DAA8D,CAAC;EACtG;EACA;EACA,MAAMW,WAAW,GAAGC,OAAO,CAACC,GAAG,CAACC,qBAAqB,IAAI,kBAAkB;;EAE3E;EACA,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGhB,QAAQ,CAAC,OAAO,CAAC;EACjD,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGlB,QAAQ,CAAC,OAAO,CAAC;;EAEjD;EACA,MAAM,CAACmB,MAAM,EAAEC,SAAS,CAAC,GAAGpB,QAAQ,CAAC,GAAG,CAAC;EACzC,MAAM,CAACqB,QAAQ,EAAEC,WAAW,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;EAC9C,MAAM,CAACuB,WAAW,EAAEC,cAAc,CAAC,GAAGxB,QAAQ,CAAC,KAAK,CAAC;EACrD;EACA,MAAM,CAACyB,WAAW,EAAEC,cAAc,CAAC,GAAG1B,QAAQ,CAAC;IAAE2B,UAAU,EAAE,KAAK;IAAEC,WAAW,EAAE,IAAI;IAAEC,SAAS,EAAE;EAAK,CAAC,CAAC;EACzG,MAAM,CAACC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG/B,QAAQ,CAAC,KAAK,CAAC;EACnE;EACA,MAAM,CAACgC,QAAQ,EAAEC,WAAW,CAAC,GAAGjC,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACkC,eAAe,EAAEC,kBAAkB,CAAC,GAAGnC,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAACoC,WAAW,EAAEC,cAAc,CAAC,GAAGrC,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACsC,cAAc,EAAEC,iBAAiB,CAAC,GAAGvC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxD;EACA,MAAM,CAACwC,QAAQ,EAAEC,WAAW,CAAC,GAAGzC,QAAQ,CAAC0C,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC;EAExF5C,SAAS,CAAC,MAAI;IAAE6C,YAAY,CAAC,CAAC;EAAE,CAAC,EAAC,EAAE,CAAC;;EAErC;EACA;EACA7C,SAAS,CAAC,MAAI;IAAE8C,sBAAsB,CAAC,CAAC;EAAE,CAAC,EAAE,CAACL,QAAQ,CAAC,CAAC;EAExD,eAAeK,sBAAsBA,CAAA,EAAE;IACrCd,qBAAqB,CAAC,IAAI,CAAC;IAC3B,IAAG;MACD;MACA,MAAMe,MAAM,GAAGC,kBAAkB,CAACL,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC;MACjF,MAAMK,EAAE,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;MACrB,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,oCAAoCmC,MAAM,MAAME,EAAE,EAAE,EAAE;QAAEK,WAAW,EAAE,SAAS;QAAEC,KAAK,EAAE;MAAW,CAAC,CAAC;MAC1I,IAAGH,GAAG,CAACI,EAAE,EAAC;QACR,MAAMC,CAAC,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;QAC1B/B,cAAc,CAAC8B,CAAC,CAAC;MACnB;IACF,CAAC,QAAME,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAAC,mCAAmC,EAAEF,CAAC,CAAC;IAAE;IAClE3B,qBAAqB,CAAC,KAAK,CAAC;EAC9B;EAEA,eAAea,YAAYA,CAAA,EAAE;IAC3B,IAAG;MACD,MAAMO,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,mBAAmB,EAAE;QAAE0C,WAAW,EAAE;MAAU,CAAC,CAAC;MACtF,IAAGF,GAAG,CAACI,EAAE,EAAC;QACR,MAAME,IAAI,GAAG,MAAMN,GAAG,CAACM,IAAI,CAAC,CAAC;QAC7BnD,UAAU,CAACmD,IAAI,CAAC;MAClB,CAAC,MAAM;QACLnD,UAAU,CAAC,IAAI,CAAC;MAClB;IACF,CAAC,QAAMoD,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;MAAEpD,UAAU,CAAC,IAAI,CAAC;IAAE;EACjD;;EAEA;EACAP,SAAS,CAAC,MAAI;IACZ,IAAGM,OAAO,IAAIA,OAAO,CAACwD,aAAa,IAAIC,KAAK,CAACC,OAAO,CAAC1D,OAAO,CAAC2D,KAAK,CAAC,IAAI3D,OAAO,CAAC2D,KAAK,CAACC,QAAQ,CAAC,aAAa,CAAC,EAAC;MAC3GC,YAAY,CAAC,CAAC;IAChB;EACF,CAAC,EAAE,CAAC7D,OAAO,CAAC,CAAC;;EAEb;EACA,MAAM,CAAC8D,YAAY,EAAEC,eAAe,CAAC,GAAGpE,QAAQ,CAAC,EAAE,CAAC;EAEpD,eAAekE,YAAYA,CAACG,CAAC,EAAC;IAC5B,IAAG;MACD;MACA,MAAMtD,QAAQ,GAAGV,OAAO,GAAIA,OAAO,CAACU,QAAQ,IAAI,OAAO,GAAI,OAAO;MAClE,MAAM+B,MAAM,GAAGC,kBAAkB,CAACL,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC;MACjF,MAAM2B,MAAM,GAAGD,CAAC,GAAG,MAAMtB,kBAAkB,CAACsB,CAAC,CAAC,EAAE,GAAG,EAAE;MACrD,MAAMlB,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,8BAA8BoC,kBAAkB,CAAChC,QAAQ,CAAC,aAAa+B,MAAM,GAAGwB,MAAM,EAAE,EAAE;QAAEjB,WAAW,EAAE;MAAU,CAAC,CAAC;MAC3J,IAAGF,GAAG,CAACI,EAAE,EAAC;QACR,MAAMC,CAAC,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;QAC1BxB,WAAW,CAAC6B,KAAK,CAACC,OAAO,CAACP,CAAC,CAAC,GAAGA,CAAC,GAAG,EAAE,CAAC;MACxC;IACF,CAAC,QAAME,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAAC,wBAAwB,EAAEF,CAAC,CAAC;IAAE;EACzD;EAEA,eAAea,aAAaA,CAACC,CAAC,EAAC;IAC7BrC,kBAAkB,CAACqC,CAAC,CAAC;IACrBnC,cAAc,CAAC,EAAE,CAAC;IAClBE,iBAAiB,CAAC,CAAC,CAAC,CAAC;IACrB,IAAG;MACD;MACA,MAAMkC,MAAM,GAAGpE,OAAO,GAAGA,OAAO,CAACU,QAAQ,GAAG,IAAI;MAChD,MAAMoC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,6BAA6BoC,kBAAkB,CAACyB,CAAC,CAACE,EAAE,CAAC,6BAA6B3B,kBAAkB,CAAC0B,MAAM,CAAC,EAAE,EAAE;QAAEpB,WAAW,EAAE;MAAU,CAAC,CAAC;MACjL,IAAGF,GAAG,CAACI,EAAE,EAAC;QACR,MAAMC,CAAC,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;QAC1BpB,cAAc,CAACyB,KAAK,CAACC,OAAO,CAACP,CAAC,CAAC,GAAGA,CAAC,GAAG,EAAE,CAAC;QACzC;QACA,IAAGiB,MAAM,IAAIX,KAAK,CAACC,OAAO,CAACP,CAAC,CAAC,IAAIA,CAAC,CAACmB,MAAM,GAAC,CAAC,EAAC;UAC1CC,mBAAmB,CAACH,MAAM,EAAED,CAAC,EAAEhB,CAAC,CAAC;QACnC;MACF,CAAC,MAAM;QACL,MAAMqB,CAAC,GAAG,MAAM1B,GAAG,CAAC2B,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAI,IAAI,CAAC;QAC1CC,KAAK,CAAC,6BAA6B,GAAG7B,GAAG,CAAC8B,MAAM,GAAG,GAAG,GAAGJ,CAAC,CAAC;MAC7D;IACF,CAAC,QAAMnB,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAAC,qBAAqB,EAAEF,CAAC,CAAC;MAAEsB,KAAK,CAAC,4BAA4B,CAAC;IAAE;EAC3F;;EAEA;EACA,SAASE,MAAMA,CAACC,CAAC,EAAEC,GAAG,EAAC;IACrB,OAAOD,CAAC,CAACE,UAAU,IAAIF,CAAC,CAACG,gBAAgB,IAAIH,CAAC,CAACI,UAAU,IAAIJ,CAAC,CAACK,QAAQ,IAAIL,CAAC,CAACM,YAAY,IAAIL,GAAG;EAClG;EAEA,eAAeR,mBAAmBA,CAACH,MAAM,EAAEiB,OAAO,EAAEC,IAAI,EAAC;IACvD,MAAMC,KAAK,GAAG,CAAC,CAAC;IAChB,MAAMC,OAAO,CAACC,GAAG,CAACH,IAAI,CAACI,GAAG,CAAC,OAAOZ,CAAC,EAAEC,GAAG,KAAK;MAC3C,MAAMY,GAAG,GAAGd,MAAM,CAACC,CAAC,EAAEC,GAAG,CAAC;MAC1B,IAAG;QACD,MAAMf,CAAC,GAAG,GAAG1D,WAAW,4CAA4CoC,kBAAkB,CAAC0B,MAAM,CAAC,eAAe1B,kBAAkB,CAAC2C,OAAO,CAAChB,EAAE,CAAC,YAAY3B,kBAAkB,CAACoC,CAAC,CAACc,aAAa,IAAE,EAAE,CAAC,EAAE;QAChM,MAAMC,CAAC,GAAG,MAAM9C,KAAK,CAACiB,CAAC,EAAE;UAAEhB,WAAW,EAAE;QAAU,CAAC,CAAC;QACpD,IAAG6C,CAAC,CAAC3C,EAAE,EAAC;UACN,MAAMC,CAAC,GAAG,MAAM0C,CAAC,CAACzC,IAAI,CAAC,CAAC;UACxB;UACAmC,KAAK,CAACI,GAAG,CAAC,GAAG,CAAC,CAACxC,CAAC,CAAC2C,YAAY;QAC/B,CAAC,MAAM;UACLP,KAAK,CAACI,GAAG,CAAC,GAAG,KAAK;QACpB;MACF,CAAC,QAAMtC,CAAC,EAAC;QAAEkC,KAAK,CAACI,GAAG,CAAC,GAAG,KAAK;MAAE;IACjC,CAAC,CAAC,CAAC;IACHzD,iBAAiB,CAACqD,KAAK,CAAC;EAC1B;EAEA,eAAeQ,eAAeA,CAACC,GAAG,EAAC;IACjC,IAAG;MACD,MAAMC,IAAI,GAAG;QACXhB,gBAAgB,EAAEpD,eAAe,CAACwC,EAAE;QACpCuB,aAAa,EAAEI,GAAG,CAACJ,aAAa;QAChCM,sBAAsB,EAAElG,OAAO,GAAGA,OAAO,CAACU,QAAQ,GAAG;MACvD,CAAC;MACD,MAAMoC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,8BAA8B,EAAE;QACpE6F,MAAM,EAAE,MAAM;QAAEnD,WAAW,EAAE,SAAS;QAAEoD,OAAO,EAAE;UAAC,cAAc,EAAC;QAAkB,CAAC;QAAEH,IAAI,EAAEI,IAAI,CAACC,SAAS,CAACL,IAAI;MACjH,CAAC,CAAC;MACF,IAAGnD,GAAG,CAACI,EAAE,EAAEyB,KAAK,CAAC,mBAAmB,CAAC,CAAC,KAAM;QAAE,MAAMH,CAAC,GAAG,MAAM1B,GAAG,CAAC2B,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAI,IAAI,CAAC;QAAEC,KAAK,CAAC,SAAS,GAAC7B,GAAG,CAAC8B,MAAM,GAAC,GAAG,GAACJ,CAAC,CAAC;MAAE;IAC/H,CAAC,QAAMnB,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;MAAEsB,KAAK,CAAC,2BAA2B,CAAC;IAAE;EACnE;EAEA,eAAe4B,OAAOA,CAAClD,CAAC,EAAC;IACvBA,CAAC,IAAIA,CAAC,CAACmD,cAAc,CAAC,CAAC;IACvB,IAAG;MACD,MAAM1D,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,iBAAiB,EAAE;QACvD6F,MAAM,EAAE,MAAM;QACdnD,WAAW,EAAE,SAAS;QACtBoD,OAAO,EAAE;UAAE,cAAc,EAAC;QAAmB,CAAC;QAC9CH,IAAI,EAAEI,IAAI,CAACC,SAAS,CAAC;UAAE5F,QAAQ;UAAEE;QAAS,CAAC;MAC7C,CAAC,CAAC;MACF,IAAGkC,GAAG,CAACI,EAAE,EAAC;QACR,MAAMC,CAAC,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;QAC1BnD,UAAU,CAAC;UAAEuD,aAAa,EAAE,IAAI;UAAEiD,MAAM,EAAEtD,CAAC,CAACsD,MAAM,IAAItD,CAAC,CAACzC,QAAQ;UAAEA,QAAQ,EAAEyC,CAAC,CAACzC;QAAS,CAAC,CAAC;QACzFiE,KAAK,CAAC,gBAAgB,IAAIxB,CAAC,CAACsD,MAAM,IAAItD,CAAC,CAACzC,QAAQ,CAAC,CAAC;MACpD,CAAC,MAAM,IAAIoC,GAAG,CAAC8B,MAAM,KAAK,GAAG,EAAE;QAC7BD,KAAK,CAAC,wBAAwB,CAAC;MACjC,CAAC,MAAM;QACL,MAAM+B,GAAG,GAAG,MAAM5D,GAAG,CAAC2B,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAI,IAAI,CAAC;QAC5CC,KAAK,CAAC,oBAAoB,GAAG7B,GAAG,CAAC8B,MAAM,GAAG,GAAG,GAAG8B,GAAG,CAAC;MACtD;IACF,CAAC,QAAMC,GAAG,EAAC;MAAErD,OAAO,CAACC,KAAK,CAACoD,GAAG,CAAC;MAAEhC,KAAK,CAAC,sBAAsB,CAAC;IAAE;EAClE;EAEA,SAASiC,gBAAgBA,CAAA,EAAE;IACzB/C,YAAY,CAACC,YAAY,CAAC;EAC5B;EAEA,eAAe+C,SAASA,CAAA,EAAE;IACxB,IAAG,CAAC/F,MAAM,EAAE;IACZK,cAAc,CAAC,IAAI,CAAC;IACpB,IAAG;MACD,MAAM2B,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,cAAcoC,kBAAkB,CAAC5B,MAAM,CAAC,EAAE,EAAE;QAAEkC,WAAW,EAAE;MAAU,CAAC,CAAC;MAC7G,IAAGF,GAAG,CAACI,EAAE,EAAC;QACR,MAAMC,CAAC,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;QAC1B;QACA,IAAID,CAAC,CAAChB,QAAQ,IAAIgB,CAAC,CAAChB,QAAQ,KAAKA,QAAQ,EAAE;UACzClB,WAAW,CAAC;YAAE6F,QAAQ,EAAE;UAAK,CAAC,CAAC;QACjC,CAAC,MAAM;UACL7F,WAAW,CAACkC,CAAC,CAAC;QAChB;MACF,CAAC,MAAM,IAAIL,GAAG,CAAC8B,MAAM,KAAK,GAAG,EAAC;QAC5B3D,WAAW,CAAC;UAAE8F,QAAQ,EAAE;QAAK,CAAC,CAAC;MACjC,CAAC,MAAM;QACL,MAAMvC,CAAC,GAAG,MAAM1B,GAAG,CAAC2B,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAI,IAAI,CAAC;QAC1CzD,WAAW,CAAC;UAAEsC,KAAK,EAAE,GAAGT,GAAG,CAAC8B,MAAM,IAAIJ,CAAC;QAAG,CAAC,CAAC;MAC9C;IACF,CAAC,QAAMnB,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;MAAEpC,WAAW,CAAC;QAAEsC,KAAK,EAAEF,CAAC,CAAC2D;MAAQ,CAAC,CAAC;IAAE;IAChE7F,cAAc,CAAC,KAAK,CAAC;EACvB;;EAEA;EACA,SAAS8F,kBAAkBA,CAAA,EAAE;IAC3BzE,sBAAsB,CAAC,CAAC;EAC1B;;EAEA;;EAEA,eAAe0E,QAAQA,CAAA,EAAE;IACvB,MAAMnE,KAAK,CAAC,GAAGzC,WAAW,kBAAkB,EAAE;MAAE0C,WAAW,EAAE;IAAU,CAAC,CAAC;IACzE/C,UAAU,CAAC,IAAI,CAAC;EAClB;EAEA,eAAekH,QAAQA,CAAA,EAAE;IACvBhH,UAAU,CAAC,IAAI,CAAC;IAChB,IAAG;MACD,MAAM8F,IAAI,GAAG;QAAE7F;MAAQ,CAAC;MACxB,MAAM0C,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGzC,WAAW,mBAAmB,EAAE;QACzD6F,MAAM,EAAE,MAAM;QACdnD,WAAW,EAAE,SAAS;QACtBoD,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CH,IAAI,EAAEI,IAAI,CAACC,SAAS,CAACL,IAAI;MAC3B,CAAC,CAAC;MACF,IAAGnD,GAAG,CAAC8B,MAAM,KAAK,GAAG,EAAC;QACpBD,KAAK,CAAC,8BAA8B,CAAC;MACvC,CAAC,MAAM;QACL,MAAMH,CAAC,GAAG,MAAM1B,GAAG,CAAC2B,IAAI,CAAC,CAAC;QAC1BE,KAAK,CAAC,SAAS,GAAG7B,GAAG,CAAC8B,MAAM,GAAG,GAAG,GAAGJ,CAAC,CAAC;MACzC;IACF,CAAC,QAAMnB,CAAC,EAAC;MAAEC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;MAAEsB,KAAK,CAAC,iBAAiB,CAAC;IAAE;IACvDxE,UAAU,CAAC,KAAK,CAAC;EACnB;EAEA,oBACEN,OAAA;IAAAuH,QAAA,gBACEvH,OAAA;MAAKwH,SAAS,EAAC,MAAM;MAAAD,QAAA,gBACnBvH,OAAA;QAAAuH,QAAA,EAAI;MAAM;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACf5H,OAAA;QAAK6H,KAAK,EAAE;UAACC,YAAY,EAAC;QAAC,CAAE;QAAAP,QAAA,GAC1B3F,kBAAkB,gBACjB5B,OAAA;UAAAuH,QAAA,EAAO;QAA0B;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,gBAEzC5H,OAAA;UAAAuH,QAAA,gBACEvH,OAAA;YAAAuH,QAAA,EAAQ;UAA6B;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,KAAC,EAACrG,WAAW,IAAIA,WAAW,CAACE,UAAU,gBAAGzB,OAAA;YAAM6H,KAAK,EAAE;cAACE,KAAK,EAAC;YAAO,CAAE;YAAAR,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,gBAAG5H,OAAA;YAAM6H,KAAK,EAAE;cAACE,KAAK,EAAC;YAAK,CAAE;YAAAR,QAAA,EAAC;UAAY;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,EAAC,GAAC,EAACrG,WAAW,CAACG,WAAW,GAAG,YAAYH,WAAW,CAACG,WAAW,EAAE,GAAG,EAAE,eAC/P1B,OAAA;YAAQwH,SAAS,EAAC,kBAAkB;YAACK,KAAK,EAAE;cAACG,UAAU,EAAC;YAAE,CAAE;YAACC,OAAO,EAAEb,kBAAmB;YAAAG,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzG,CACN,eAED5H,OAAA;UAAK6H,KAAK,EAAE;YAACK,SAAS,EAAC;UAAC,CAAE;UAAAX,QAAA,gBACxBvH,OAAA;YAAAuH,QAAA,GAAO,oBAAkB,eAAAvH,OAAA;cAAAuH,QAAA,EAAO/E,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,IAAI;YAAU;cAAAgF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC,eAC9F5H,OAAA;YAAK6H,KAAK,EAAE;cAACM,SAAS,EAAC,GAAG;cAAEC,QAAQ,EAAC,MAAM;cAAEC,UAAU,EAAC,SAAS;cAAEC,OAAO,EAAC;YAAC,CAAE;YAAAf,QAAA,EAAEf,IAAI,CAACC,SAAS,CAAClF,WAAW,EAAE,IAAI,EAAE,CAAC;UAAC;YAAAkG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,EACLzH,OAAO,IAAIA,OAAO,CAACwD,aAAa,gBAC/B3D,OAAA;QAAAuH,QAAA,gBACEvH,OAAA;UAAAuH,QAAA,GAAG,oBAAkB,eAAAvH,OAAA;YAAAuH,QAAA,EAASpH,OAAO,CAACyG,MAAM,IAAIzG,OAAO,CAACU;UAAQ;YAAA4G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAS,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAC9E5H,OAAA;UAAQwH,SAAS,EAAC,kBAAkB;UAACS,OAAO,EAAEZ,QAAS;UAAAE,QAAA,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3E,CAAC,gBAEN5H,OAAA;QAAAuH,QAAA,gBACEvH,OAAA;UAAAuH,QAAA,GAAG,iFAA4E,eAAAvH,OAAA;YAAAuH,QAAA,EAAM;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,aAAS,eAAA5H,OAAA;YAAAuH,QAAA,EAAM;UAAK;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,MAAE;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAClI5H,OAAA;UAAMuI,QAAQ,EAAE7B,OAAQ;UAACmB,KAAK,EAAE;YAACW,OAAO,EAAC,MAAM;YAAEC,GAAG,EAAC,CAAC;YAAEC,UAAU,EAAC;UAAQ,CAAE;UAAAnB,QAAA,gBAC3EvH,OAAA;YAAOwH,SAAS,EAAC,OAAO;YAACmB,KAAK,EAAE9H,QAAS;YAAC+H,QAAQ,EAAGpF,CAAC,IAAG1C,WAAW,CAAC0C,CAAC,CAACqF,MAAM,CAACF,KAAK;UAAE;YAAAlB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACxF5H,OAAA;YAAOwH,SAAS,EAAC,OAAO;YAACsB,IAAI,EAAC,UAAU;YAACH,KAAK,EAAE5H,QAAS;YAAC6H,QAAQ,EAAGpF,CAAC,IAAGxC,WAAW,CAACwC,CAAC,CAACqF,MAAM,CAACF,KAAK;UAAE;YAAAlB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACxG5H,OAAA;YAAQwH,SAAS,EAAC,gBAAgB;YAACsB,IAAI,EAAC,QAAQ;YAAAvB,QAAA,EAAC;UAAY;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAClE,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CACN;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,EAGLzH,OAAO,IAAIA,OAAO,CAACwD,aAAa,IAAIC,KAAK,CAACC,OAAO,CAAC1D,OAAO,CAAC2D,KAAK,CAAC,IAAI3D,OAAO,CAAC2D,KAAK,CAACC,QAAQ,CAAC,aAAa,CAAC,gBACxG/D,OAAA;MAAKwH,SAAS,EAAC,MAAM;MAAAD,QAAA,gBACnBvH,OAAA;QAAAuH,QAAA,EAAI;MAAiB;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC1B5H,OAAA;QAAK6H,KAAK,EAAE;UAACW,OAAO,EAAC,MAAM;UAAEC,GAAG,EAAC,CAAC;UAAEC,UAAU,EAAC;QAAQ,CAAE;QAAAnB,QAAA,gBACvDvH,OAAA;UAAOwH,SAAS,EAAC,OAAO;UAACuB,WAAW,EAAC,4BAA4B;UAACJ,KAAK,EAAE1E,YAAa;UAAC2E,QAAQ,EAAGpF,CAAC,IAAGU,eAAe,CAACV,CAAC,CAACqF,MAAM,CAACF,KAAK;QAAE;UAAAlB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACzI5H,OAAA;UAAQwH,SAAS,EAAC,gBAAgB;UAACS,OAAO,EAAElB,gBAAiB;UAAAQ,QAAA,EAAC;QAAM;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC7E5H,OAAA;UAAQwH,SAAS,EAAC,kBAAkB;UAACS,OAAO,EAAEA,CAAA,KAAI;YAAE/D,eAAe,CAAC,EAAE,CAAC;YAAEF,YAAY,CAAC,CAAC;UAAE,CAAE;UAAAuD,QAAA,EAAC;QAAO;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzG,CAAC,eACN5H,OAAA;QAAK6H,KAAK,EAAE;UAACK,SAAS,EAAC;QAAE,CAAE;QAAAX,QAAA,gBACzBvH,OAAA;UAAAuH,QAAA,EAAI;QAAS;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EACjB9F,QAAQ,CAAC2C,MAAM,KAAK,CAAC,gBAAGzE,OAAA;UAAAuH,QAAA,EAAK;QAAgB;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,gBAClD5H,OAAA;UAAAuH,QAAA,EACGzF,QAAQ,CAAC+D,GAAG,CAAC,CAACvB,CAAC,EAAE0E,CAAC,kBACjBhJ,OAAA;YAAAuH,QAAA,GACGjD,CAAC,CAACsC,MAAM,EAAC,IAAE,EAACtC,CAAC,CAACE,EAAE,EAAC,IAAE,eAAAxE,OAAA;cAAQwH,SAAS,EAAC,kBAAkB;cAACS,OAAO,EAAEA,CAAA,KAAI5D,aAAa,CAACC,CAAC,CAAE;cAAAiD,QAAA,EAAC;YAAc;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA,GADxGoB,CAAC;YAAAvB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAEN,CACL;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACA,CACL,EAEA5F,eAAe,iBACdhC,OAAA;UAAK6H,KAAK,EAAE;YAACK,SAAS,EAAC;UAAE,CAAE;UAAAX,QAAA,gBACzBvH,OAAA;YAAAuH,QAAA,GAAI,gBAAc,EAACvF,eAAe,CAAC4E,MAAM,EAAC,IAAE,EAAC5E,eAAe,CAACwC,EAAE,EAAC,GAAC;UAAA;YAAAiD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACrE1F,WAAW,CAACuC,MAAM,KAAK,CAAC,gBAAGzE,OAAA;YAAAuH,QAAA,EAAK;UAA4B;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,gBACjE5H,OAAA;YAAAuH,QAAA,EACGrF,WAAW,CAAC2D,GAAG,CAAC,CAACZ,CAAC,EAACC,GAAG,kBACrBlF,OAAA;cAAAuH,QAAA,GACGtC,CAAC,CAACc,aAAa,EAAC,KAAG,EAACd,CAAC,CAACgE,gBAAgB,eACvCjJ,OAAA;gBAAK6H,KAAK,EAAE;kBAACW,OAAO,EAAC,cAAc;kBAAER,UAAU,EAAC;gBAAC,CAAE;gBAAAT,QAAA,gBACjDvH,OAAA;kBAAGwH,SAAS,EAAC,MAAM;kBAAC0B,IAAI,EAAEjE,CAAC,CAACM,YAAY,IAAI,GAAI;kBAACsD,MAAM,EAAC,QAAQ;kBAACM,GAAG,EAAC,YAAY;kBAAA5B,QAAA,EAAC;gBAAa;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC,eACnG5H,OAAA;kBAAQwH,SAAS,EAAC,kBAAkB;kBAACK,KAAK,EAAE;oBAACG,UAAU,EAAC;kBAAC,CAAE;kBAACC,OAAO,EAAEA,CAAA,KAAI/B,eAAe,CAACjB,CAAC,CAAE;kBAAAsC,QAAA,EAAC;gBAAgB;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAQ,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnH,CAAC;YAAA,GALC1C,GAAG;cAAAuC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAMR,CACL;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACA,CACL;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,GACJ,IAAI;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAGL,CAAC;AAEV;AAAC1H,EAAA,CAnTQD,WAAW;AAAAmJ,EAAA,GAAXnJ,WAAW;AAqTpB,eAAeA,WAAW;AAAC,IAAAmJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}